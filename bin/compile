#!/bin/bash

mkdir -p "$1" "$2" "$3"
BUILD_PATH=$(cd "$1" && pwd)
CACHE_PATH=$(cd "$2" && pwd)
BUILDPACK_PREFIX=nmap

NMAP_VERSION="7.91"
if [ -f "$3"/NMAP_VERSION ]; then
  NMAP_VERSION="$(cat "$3"/NMAP_VERSION)"
fi
NMAP_NAME=nmap-$NMAP_VERSION
echo "$CACHE_PATH"/"$BUILDPACK_PREFIX"/"$NMAP_NAME"/bin/nmap

if [ ! -f "$CACHE_PATH"/"$BUILDPACK_PREFIX"/"$NMAP_NAME"/bin/nmap ]; then
  echo "-----> Installing $NMAP_NAME"
  apt-get install nmap -y
else
  echo "-----> Using cached nmap version"
fi
